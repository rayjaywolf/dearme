{% comment %}
  Ingredients section
{% endcomment %}

<section
  class="ingredients-section"
  style="background: {{ section.settings.background_color }} url('{{ "noise.png" | asset_url }}'); background-size: 150px 150px; background-repeat: repeat;"
>
  <div class="ingredients-container">
    <h2
      class="ingredients-title"
      data-split="heading"
      style="font-family: {{ section.settings.title_font }}, serif; font-style: {{ section.settings.title_style }}; text-transform: {{ section.settings.title_transform }}; color: {{ section.settings.title_color }};"
    >
      <em style="font-family: {{ section.settings.title_em_font }}, serif; font-style: {{ section.settings.title_em_style }}; color: {{ section.settings.title_em_color }}; text-transform: {{ section.settings.title_em_transform }};">
        {{- 'Enriched' | capitalize -}}
      </em>
      with Benefits
    </h2>
    <div class="ingredients-image-container">
      <div class="benefits-grid">
        <div class="benefit-item">
          <img src="{{ 'elixir.png' | asset_url }}" alt="Anti-Aging Elixir" loading="lazy" width="60" height="60">
          <h4 class="benefit-title" style="color: {{ section.settings.title_color }};">Anti-Aging Elixir</h4>
        </div>
        <div class="benefit-item">
          <img src="{{ 'hydration.png' | asset_url }}" alt="Deep Hydration" loading="lazy" width="60" height="60">
          <h4 class="benefit-title" style="color: {{ section.settings.title_color }};">Deep Hydration</h4>
        </div>
        <div class="benefit-item">
          <img src="{{ 'complexion.png' | asset_url }}" alt="Luminous Complexion" loading="lazy" width="60" height="60">
          <h4 class="benefit-title" style="color: {{ section.settings.title_color }};">Luminous Complexion</h4>
        </div>
        <div class="benefit-item">
          <img
            src="{{ 'spots.png' | asset_url }}"
            alt="Dark Spot Diminishment"
            loading="lazy"
            width="60"
            height="60"
          >
          <h4 class="benefit-title" style="color: {{ section.settings.title_color }};">Dark Spot Diminishment</h4>
        </div>
      </div>
      <img
        src="{{ 'bottle.png' | asset_url }}"
        alt="Ingredients Image"
        class="ingredients-image"
        loading="lazy"
        width="300"
        height="300"
      >
      <p
        class="ingredients-description"
        data-split="subheading"
        style="font-family: {{ section.settings.description_font }}, serif; font-style: {{ section.settings.description_style }}; text-transform: {{ section.settings.description_transform }}; color: {{ section.settings.description_color }};"
      >
        Hand-selected Ayurvedic gems and nature's vibrant actives, united in our sacred elixir to deeply nurture and
        unveil your inherent radianceâ€”no compromise.
      </p>
    </div>
  </div>
</section>

<style>
  .ingredients-section {
    height: 100vh;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
  }

  .ingredients-container {
    text-align: center;
  }

  .ingredients-title {
    font-weight: 200;
    font-size: 3rem;
    line-height: 1.2;
    margin-bottom: 4rem;
    overflow: hidden;
  }

  .ingredients-description {
    text-align: left;
    font-size: 0.8rem;
    width: 100%;
    overflow: hidden;
    grid-column: 3;
  }

  .ingredients-image-container {
    display: grid;
    align-items: center;
    grid-template-columns: repeat(3, 1fr);
    gap: 4rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  .ingredients-image {
    max-width: 85%;
    height: auto;
    display: block;
    margin: 0 auto;
    grid-column: 2;
  }

  .benefits-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 2rem;
    grid-column: 1;
    position: relative;
  }

  .benefits-grid::before,
  .benefits-grid::after {
    content: '';
    position: absolute;
    background-color: {{ section.settings.grid_border_color }};
  }


  .benefit-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    text-align: center;
    gap: 1rem;
  }

  .benefit-item img {
    width: 60px;
    height: 60px;
    object-fit: contain;
  }

  .benefit-title {
    font-family: 'Inter', serif;
    font-size: 1rem;
    font-weight: 400;
    line-height: 1.3;
    margin: 0;
  }

  @media screen and (max-width: 768px) {
    .ingredients-title {
      font-size: 2.5rem;
    }

    .ingredients-image-container {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .benefits-grid {
      grid-column: 1;
      gap: 1.5rem;
    }

    .ingredients-image {
      grid-column: 1;
      max-width: 60%;
    }

    .ingredients-description {
      grid-column: 1;
      text-align: center;
    }
  }
</style>

{% schema %}
{
  "name": "Ingredients Section",
  "settings": [
    {
      "type": "header",
      "content": "Background Settings"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#fef9f2"
    },
    {
      "type": "header",
      "content": "Typography Settings"
    },
    {
      "type": "select",
      "id": "title_font",
      "label": "Title Font",
      "options": [
        {
          "value": "Gumani",
          "label": "Gumani"
        },
        {
          "value": "Instrument Serif",
          "label": "Instrument Serif"
        },
        {
          "value": "PPEditorial New",
          "label": "PPEditorial New"
        },
        {
          "value": "Work Sans",
          "label": "Work Sans"
        }
      ],
      "default": "Instrument Serif"
    },
    {
      "type": "select",
      "id": "title_style",
      "label": "Title Font Style",
      "options": [
        {
          "value": "normal",
          "label": "Regular"
        },
        {
          "value": "italic",
          "label": "Italic"
        }
      ],
      "default": "normal"
    },
    {
      "type": "select",
      "id": "title_em_font",
      "label": "Title Emphasized Font",
      "options": [
        {
          "value": "Gumani",
          "label": "Gumani"
        },
        {
          "value": "Instrument Serif",
          "label": "Instrument Serif"
        },
        {
          "value": "PPEditorial New",
          "label": "PPEditorial New"
        },
        {
          "value": "Work Sans",
          "label": "Work Sans"
        }
      ],
      "default": "Instrument Serif"
    },
    {
      "type": "select",
      "id": "title_em_style",
      "label": "Title Emphasized Style",
      "options": [
        {
          "value": "normal",
          "label": "Regular"
        },
        {
          "value": "italic",
          "label": "Italic"
        }
      ],
      "default": "italic"
    },
    {
      "type": "select",
      "id": "title_em_transform",
      "label": "Title Emphasized Text Transform (Purest)",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "capitalize", "label": "Capitalize" },
        { "value": "uppercase", "label": "Uppercase" },
        { "value": "lowercase", "label": "Lowercase" }
      ],
      "default": "capitalize"
    },
    {
      "type": "select",
      "id": "description_font",
      "label": "Description Font",
      "options": [
        {
          "value": "Gumani",
          "label": "Gumani"
        },
        {
          "value": "Inter",
          "label": "Inter"
        },
        {
          "value": "Instrument Serif",
          "label": "Instrument Serif"
        },
        {
          "value": "PPEditorial New",
          "label": "PPEditorial New"
        },
        {
          "value": "Work Sans",
          "label": "Work Sans"
        }
      ],
      "default": "Inter"
    },
    {
      "type": "select",
      "id": "description_style",
      "label": "Description Font Style",
      "options": [
        {
          "value": "normal",
          "label": "Regular"
        },
        {
          "value": "italic",
          "label": "Italic"
        }
      ],
      "default": "normal"
    },
    {
      "type": "select",
      "id": "title_transform",
      "label": "Title Text Transform",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "capitalize",
          "label": "Capitalize"
        },
        {
          "value": "uppercase",
          "label": "Uppercase"
        },
        {
          "value": "lowercase",
          "label": "Lowercase"
        }
      ],
      "default": "capitalize"
    },
    {
      "type": "select",
      "id": "description_transform",
      "label": "Description Text Transform",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "capitalize",
          "label": "Capitalize"
        },
        {
          "value": "uppercase",
          "label": "Uppercase"
        },
        {
          "value": "lowercase",
          "label": "Lowercase"
        }
      ],
      "default": "none"
    },
    {
      "type": "header",
      "content": "Color Settings"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#63001f"
    },
    {
      "type": "color",
      "id": "title_em_color",
      "label": "Title Emphasized Color",
      "default": "#63001f"
    },
    {
      "type": "color",
      "id": "description_color",
      "label": "Description Color",
      "default": "#63001fd1"
    },
    {
      "type": "color",
      "id": "grid_border_color",
      "label": "Grid Border Color",
      "default": "#63001fd1"
    }
  ],
  "presets": [
    {
      "name": "Ingredients Section"
    }
  ]
}
{% endschema %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (typeof gsap !== 'undefined' && typeof SplitText !== 'undefined' && typeof CustomEase !== 'undefined') {
      gsap.registerPlugin(SplitText, CustomEase);
      CustomEase.create('osmo-ease', '0.625, 0.05, 0, 1');

      var section = document.querySelector('.ingredients-section');
      if (!section) return;

      function initIngredientsAnimation() {
        const heading = document.querySelector('.ingredients-title');
        const description = document.querySelector('.ingredients-description');

        if (!heading) return;

        // Split heading
        const headingSplit = new SplitText(heading, {
          type: 'lines',
          linesClass: 'line',
        });

        headingSplit.lines.forEach((line) => {
          const wrapper = document.createElement('div');
          wrapper.style.overflow = 'hidden';
          line.parentNode.insertBefore(wrapper, line);
          wrapper.appendChild(line);
        });

        gsap.set(headingSplit.lines, { yPercent: 110 });

        // Remove SplitText and animation for description
        return { headingSplit };
      }

      // Initialize SplitText after fonts are ready
      let splitTexts;
      if (document.fonts && document.fonts.ready) {
        document.fonts.ready.then(function () {
          splitTexts = initIngredientsAnimation();
        });
      } else {
        setTimeout(() => {
          splitTexts = initIngredientsAnimation();
        }, 100);
      }

      // Create observer for text animation
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries[0].isIntersecting && splitTexts) {
            const tl = gsap.timeline();

            tl.to(splitTexts.headingSplit.lines, {
              yPercent: 0,
              duration: 1.6,
              stagger: 0.15,
              ease: 'osmo-ease',
            });

            // Animate ingredients list items
            tl.from(
              '.benefit-item',
              {
                opacity: 0,
                y: 40,
                duration: 1.2,
                stagger: 0.18,
                ease: 'power3.out',
              },
              '-=1'
            );

            // Disconnect observer after triggering
            observer.disconnect();
          }
        },
        { threshold: 0.1 } // Same threshold as product showcase
      );

      observer.observe(section);

      // Remove parallax effect
      // window.addEventListener('load', function() {
      //   var img = document.querySelector('.ingredients-image');
      //   if (img && typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {
      //     gsap.to(img, {
      //       y: -150, // Parallax amount (adjust for more/less effect)
      //       ease: 'none',
      //       scrollTrigger: {
      //         trigger: section,
      //         start: 'top bottom',
      //         end: 'bottom top',
      //         scrub: true
      //       }
      //     });
      //   }
      // });
    }
  });
</script>
